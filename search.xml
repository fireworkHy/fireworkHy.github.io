<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å…¥å‘åšå®¢å’¯Îµ=( oï½€Ï‰â€²)ãƒ</title>
    <url>/2020/10/17/hello-world/</url>
    <content><![CDATA[<h2 id="è¦ä¸å°±éšæ‰‹è®°ä¸‹å…¥å‘è¿‡ç¨‹å§ğŸ˜"><a href="#è¦ä¸å°±éšæ‰‹è®°ä¸‹å…¥å‘è¿‡ç¨‹å§ğŸ˜" class="headerlink" title="è¦ä¸å°±éšæ‰‹è®°ä¸‹å…¥å‘è¿‡ç¨‹å§ğŸ˜"></a>è¦ä¸å°±éšæ‰‹è®°ä¸‹å…¥å‘è¿‡ç¨‹å§ğŸ˜</h2><ol>
<li><p>é¦–å…ˆå‘¢ï¼Œnpmï¼Œgitå•¥çš„ä½ æ€»è¯¥è¦è£…å§ï¼Œè®°å¾—æ¢æˆæ·˜å®æºï¼Œè¦ä¸ç„¶å¯èƒ½è´¼æ…¢(è™½ç„¶ä¿ºæ²¡è¯•è¿‡(+_+))ã€‚</p>
</li>
<li><p>è¿™é‡Œç”¨çš„æ˜¯hexoæ¡†æ¶ï¼Œæ‰€ä»¥å°±ç›´æ¥å»<a href="https://hexo.io/">å®˜ç½‘</a>æ‰¾å§<br>åœ¨éšä¾¿ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­å»ï¼Œå¯ä»¥ç”¨<code>git bash</code>ï¼Œä¹Ÿå¯ä»¥ç”¨winçš„cmd(è¿™é‡Œæé†’ä¸‹ï¼šæœ€å¥½ç”¨ç®¡ç†å‘˜ç‰ˆï¼ˆwin+xå°±èƒ½çœ‹è§)ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">hexo init blog</span><br><span class="line">cd blog</span><br><span class="line">npm install</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸ªå‘æœ‰ç‚¹çƒ¦çš„ï¼Œåœ¨<code>hexo init blog</code>çš„æ—¶å€™ä¼šæœ‰å¯¹è¿œç¨‹ä»“åº“çš„cloningï¼Œä¼šå¾ˆæ…¢ï¼Œä¹‹å‰ä¸€ç›´å¡åœ¨é‚£å„¿ä¸€ç›´ä»¥ä¸ºæ˜¯æˆ‘è¿™é‡Œä»£ç†é—®é¢˜ï¼Œç»“æœã€‚ã€‚ã€‚ã€‚æ˜‚ï¼Œå¯¹ï¼Œæˆ‘å¤šç­‰äº†ä¸€ä¼šå„¿å°±è¡Œäº†ï¼Œä¹‹å‰ä½¿ç”¨<code>git bash</code>çš„ç»“æœå¥½åƒæœ‰æŠ¥é”™â€¦..æå¿˜äº†ï¼Œ ç®—äº†( &amp; _ &amp; )ä½ ä¸åœ¨æ„çš„å§</p>
</li>
<li><p>å†å°±æ˜¯å»githubå»ºä¸€ä¸ªä»“åº“å‘½åä¸º<code>YourGithubName.github.io</code>ï¼Œ æ¯”å¦‚æˆ‘è¿™ä¸ªå°±å«<code>fireworkHy.github.io</code></p>
</li>
<li><p>å†å›æ¥ï¼Œå»æœ¬åœ°åšå®¢æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°<code>_config.yml</code>è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œç¿»åˆ°å®ƒçš„æœ€ä¸‹é¢ï¼š<br>æ‰¾åˆ°deployï¼Œè¿™ä¸ªæ˜¯ç”±hexoæä¾›çš„ä¸€é”®éƒ¨ç½²çš„é…ç½®åœ°æ–¹ï¼ŒåŠ ä¸Šè¿™äº›ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:&#x2F;&#x2F;github.com&#x2F;fireworkHy&#x2F;fireworkHy.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>é»˜è®¤æ˜¯ä¹Ÿä¼šæ”¾åœ¨masteråˆ†æ”¯ä¸Šï¼Œä½†æ˜¯æœ€å¥½æ˜¾å¼é…ç½®ä¸‹ã€‚</p>
</li>
<li><p>æœ€åå°±æ˜¯éƒ¨ç½²äº†, å›åˆ°å‘½ä»¤è¡Œä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<p>å°±æ²¡äº†ï¼Œæ˜‚ï¼Œå°±è¿™æ ·ï¼Œåˆ«è§‰å¾—å¤ªéš¾å“Ÿï¼Œä¸€æ­¥åˆ°ä½</p>
</li>
</ol>
<blockquote>
<p>æµ‹è¯•ä¹‹åå‘ç°è®¿é—®å¤ªæ…¢äº†ï¼Œç¿»å¢™çš„è¯è¿˜å¥½ï¼Œå¦‚æœå›¾ç‰‡å¤šäº†ï¼Œèµ„æºæ‹¥æŒ¤äº†ï¼Œè®¿é—®å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œè™½ç„¶ã€‚ã€‚ã€‚æˆ‘æ„Ÿè§‰å¼€å‘çš„åº”è¯¥éƒ½ç¿»å¢™çš„å§hhhï¼Œä¸ä¼šè¿˜æœ‰äººä¸ä¼šç¿»å¢™å§ï¼Œä¸ä¼šå§ä¸ä¼šå§ğŸ§</p>
<p>æ‰€ä»¥å‡†å¤‡åœ¨ç äº‘ä¸Šéƒ¨ç½²åšå®¢ï¼Œè¿™ä¸¤è¾¹éƒ½ä¼šæ›´æ–°çš„ï¼Œç äº‘çš„è¯ï¼Œç«™ç‚¹åœ¨å›½å†…ï¼Œä¸€å®šä¼šå¾ˆå¿«ğŸ˜‹</p>
</blockquote>
<h2 id="ä¸‹é¢ç»™å‡ºä¸€äº›å¯èƒ½å¸¸ç”¨çš„hexoå‘½ä»¤ğŸˆ"><a href="#ä¸‹é¢ç»™å‡ºä¸€äº›å¯èƒ½å¸¸ç”¨çš„hexoå‘½ä»¤ğŸˆ" class="headerlink" title="ä¸‹é¢ç»™å‡ºä¸€äº›å¯èƒ½å¸¸ç”¨çš„hexoå‘½ä»¤ğŸˆ"></a>ä¸‹é¢ç»™å‡ºä¸€äº›å¯èƒ½å¸¸ç”¨çš„hexoå‘½ä»¤ğŸˆ</h2><h3 id="å»ºç«‹æ–°åšæ–‡"><a href="#å»ºç«‹æ–°åšæ–‡" class="headerlink" title="å»ºç«‹æ–°åšæ–‡"></a>å»ºç«‹æ–°åšæ–‡</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>è¯¦æƒ…æˆ³è¿™å„¿ğŸ‘‰: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="æœ¬åœ°è·‘æœåŠ¡"><a href="#æœ¬åœ°è·‘æœåŠ¡" class="headerlink" title="æœ¬åœ°è·‘æœåŠ¡"></a>æœ¬åœ°è·‘æœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>æˆ³è¿™å„¿æˆ³è¿™å„¿ğŸ‘‰: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="ç”Ÿæˆé™æ€æ–‡ä»¶"><a href="#ç”Ÿæˆé™æ€æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé™æ€æ–‡ä»¶"></a>ç”Ÿæˆé™æ€æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶è¿˜æ˜¯æˆ³è¿™å„¿å’¯ğŸ™ƒ: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="éƒ¨ç½²åˆ°è¿œç¨‹ç«™ç‚¹"><a href="#éƒ¨ç½²åˆ°è¿œç¨‹ç«™ç‚¹" class="headerlink" title="éƒ¨ç½²åˆ°è¿œç¨‹ç«™ç‚¹"></a>éƒ¨ç½²åˆ°è¿œç¨‹ç«™ç‚¹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>ä¸å¤š1313ğŸ‘‰: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>æ— æ³•å°†â€œvueâ€é¡¹è¯†åˆ«ä¸º cmdletã€å‡½æ•°ã€è„šæœ¬æ–‡ä»¶æˆ–å¯è¿è¡Œç¨‹åºçš„åç§°</title>
    <url>/2020/10/17/vue%E6%97%A0%E6%95%88%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[<blockquote>
<p>é…ç½®å®‰è£…vue-cliåï¼Œåˆ›å»ºé¡¹ç›®æ—¶é‡ä¸Šçš„é—®é¢˜ã€‚å„ç§å¥‡æŠ€æ·«å·§éƒ½æ²¡ç”¨ï¼Œæœ€ååœ¨ç½‘ä¸Šæ‰¾ç€ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<h2 id="çŠ¶å†µ"><a href="#çŠ¶å†µ" class="headerlink" title="çŠ¶å†µ"></a>çŠ¶å†µ</h2><p>å¦‚æœåœ¨ä½¿ç”¨ vue å‘½ä»¤çš„æ—¶å€™æç¤ºï¼š</p>
<blockquote>
<p>vue : æ— æ³•å°†â€œvueâ€é¡¹è¯†åˆ«ä¸º cmdletã€å‡½æ•°ã€è„šæœ¬æ–‡ä»¶æˆ–å¯è¿è¡Œç¨‹åºçš„åç§°ã€‚è¯·æ£€æŸ¥åç§°çš„æ‹¼å†™ï¼Œå¦‚æœåŒ…æ‹¬è·¯å¾„ï¼Œè¯·ç¡®ä¿è·¯å¾„æ­£ç¡®ï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚</p>
</blockquote>
<p>æˆ–è€…</p>
<blockquote>
<p>vueä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€¦</p>
</blockquote>
<p>è¡¨ç¤ºç³»ç»Ÿæ²¡æœ‰æ‰¾åˆ° vue.cmd çš„åœ°å€ï¼Œéœ€è¦å°†åœ°å€åŠ å…¥åˆ°ç¯å¢ƒå˜é‡ã€‚</p>
<p>æ˜¯çš„ï¼Œæ¥ä¸‹æ¥è§£å†³æ–¹æ¡ˆå°±æ˜¯å°†å®ƒæ‰€å±ç›®å½•æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­</p>
<h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æœç´¢vue.cmdï¼Œè·³åˆ°å®ƒçš„ç›®å½•ä¸­ï¼Œå¤åˆ¶å®ƒçš„ç›®å½•è·¯å¾„ï¼Œå°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚</p>
<h2 id="OK-ç™½ç™½ğŸ˜‹"><a href="#OK-ç™½ç™½ğŸ˜‹" class="headerlink" title="OK~      ç™½ç™½ğŸ˜‹"></a>OK~      ç™½ç™½ğŸ˜‹</h2>]]></content>
  </entry>
  <entry>
    <title>koaæµ…è¯»</title>
    <url>/2020/11/18/koa%E6%B5%85%E8%AF%BB/</url>
    <content><![CDATA[<h1 id="Koa2"><a href="#Koa2" class="headerlink" title="Koa2"></a>Koa2</h1><blockquote>
<p>ç›´å¥”ä¸»é¢˜ï¼Œç›´æ¥ git cloneï¼Œåˆ›å»ºæµ‹è¯•æ ·ä¾‹æ¥æ…¢æ…¢è°ƒè¯•ã€‚</p>
</blockquote>
<p><img src="https://i.loli.net/2020/11/18/XbogUmaJNWVz9Fd.png" alt="image-20201118233716030"></p>
<p>å•æ­¥è°ƒè¯•åï¼Œé¦–å…ˆè¿›å…¥koaApplicationçš„æ„é€ å‡½æ•°ä¸­ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// test.js</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa()</span><br><span class="line"></span><br><span class="line"><span class="comment">// application.js</span></span><br><span class="line"><span class="comment">// è¯¥Applicationç±»ç»§æ‰¿è‡ªEmitterç±»ï¼Œä½¿å¾—koaå®ä¾‹å…·æœ‰å¤„ç†å¼‚æ­¥ I/O æ“ä½œçš„èƒ½åŠ›</span></span><br><span class="line"><span class="comment">// å°æä¸€å¥ï¼ševents æ¨¡å—åªæä¾›äº†ä¸€ä¸ªå¯¹è±¡ï¼š events.EventEmitterã€‚EventEmitter çš„æ ¸å¿ƒå°±æ˜¯äº‹ä»¶è§¦å‘ä¸äº‹ä»¶ç›‘å¬å™¨åŠŸèƒ½çš„å°è£…ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">Emitter</span> </span>&#123;</span><br><span class="line"> 		<span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">      <span class="built_in">super</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ä¸‹é¢å¤§éƒ¨åˆ†æ˜¯é…ç½®</span></span><br><span class="line">      options = options || &#123;&#125;;</span><br><span class="line">      <span class="built_in">this</span>.proxy = options.proxy || <span class="literal">false</span>;</span><br><span class="line">      <span class="built_in">this</span>.subdomainOffset = options.subdomainOffset || <span class="number">2</span>;</span><br><span class="line">      <span class="built_in">this</span>.proxyIpHeader = options.proxyIpHeader || <span class="string">&#x27;X-Forwarded-For&#x27;</span>;</span><br><span class="line">      <span class="built_in">this</span>.maxIpsCount = options.maxIpsCount || <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">this</span>.env = options.env || process.env.NODE_ENV || <span class="string">&#x27;development&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (options.keys) <span class="built_in">this</span>.keys = options.keys;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// è¿™é‡Œå¼€å§‹</span></span><br><span class="line">      <span class="comment">// åˆ›å»ºä¸­é—´ä»¶æ•°ç»„</span></span><br><span class="line">      <span class="built_in">this</span>.middleware = [];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// åˆ›å»ºå…¨å±€ä¾èµ–çš„ä¸Šä¸‹æ–‡ï¼Œkoaåº”ç”¨çš„ä¸»è¦æ“ä½œéƒ½æ˜¯åœ¨ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œçš„</span></span><br><span class="line">      <span class="built_in">this</span>.context = <span class="built_in">Object</span>.create(context);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// æ„å»ºè¯·æ±‚äºå“åº”</span></span><br><span class="line">      <span class="built_in">this</span>.request = <span class="built_in">Object</span>.create(request);</span><br><span class="line">      <span class="built_in">this</span>.response = <span class="built_in">Object</span>.create(response);</span><br><span class="line">      <span class="comment">// util.inspect.custom support for node 6+</span></span><br><span class="line">      <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">      <span class="keyword">if</span> (util.inspect.custom) &#123;</span><br><span class="line">        <span class="built_in">this</span>[util.inspect.custom] = <span class="built_in">this</span>.inspect;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œåˆ›å»ºctxã€reqã€resæ—¶ï¼Œç”¨çš„æ˜¯Object.create()è€Œä¸æ˜¯ç›´æ¥èµ‹å€¼ï¼Œæˆ‘çš„ç†è§£æ˜¯å¯èƒ½æ˜¯ä¸ºäº†åšåˆ°ç»§æ‰¿çš„æ•ˆæœï¼Œå¦‚æœä»…ä»…æ˜¯ç®€å•çš„èµ‹å€¼ï¼šthis.context = context;è¿™æ ·çš„è¯å°±åªæ˜¯ä¼ é€’äº†contextå¯¹è±¡çš„åœ°å€ï¼Œæ— æ³•å®ç°ç»§æ‰¿è¿™ç§ç‰¹æ€§ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// test.js</span></span><br><span class="line">app.use(fn1)</span><br><span class="line">app.use(fn2)</span><br><span class="line">app.use(fn3)</span><br><span class="line"></span><br><span class="line"><span class="comment">// application.js</span></span><br><span class="line">  use(fn) &#123;</span><br><span class="line">    <span class="comment">// å…¶ä»–çš„ä»£ç æˆ‘å·²åˆ å»</span></span><br><span class="line">    <span class="comment">// å°†å®ä¾‹ä¸­ä½¿ç”¨çš„ä¸­é—´ä»¶å‡½æ•°æ³¨å†Œåˆ°æ•°ç»„ä¸­å»</span></span><br><span class="line">    <span class="built_in">this</span>.middleware.push(fn);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// test.js</span></span><br><span class="line">app.listen(<span class="number">3000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// application.js</span></span><br><span class="line">  listen(...args) &#123;</span><br><span class="line">    <span class="keyword">const</span> server = http.createServer(<span class="built_in">this</span>.callback()); <span class="comment">// è¿™é‡Œè°ƒç”¨äº†callbackæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> server.listen(...args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  callback() &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œç»™äº†ä¸€ä¸ªfn----&gt;é‡ç‚¹ï¼ï¼ï¼</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨composeå‡½æ•°è¿›è¡Œæ´‹è‘±æ¨¡å‹çš„æ„å»ºï¼Œå½“æˆ‘ä»¬å†æ¬¡è°ƒç”¨çš„æ—¶å€™å°±ä¼šæ˜¯å‰¥æ´‹è‘±å¼åœ°ä¾ç…§é¡ºåºï¼Œè‡ªå‰å‘åï¼Œåˆè‡ªåå‘å‰</span></span><br><span class="line">    <span class="keyword">const</span> fn = compose(<span class="built_in">this</span>.middleware);</span><br><span class="line">    <span class="comment">// æ„é€ ä¸€ä¸ªå¯¹è¯·æ±‚çš„å¤„ç†çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> handleRequest = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// æ„é€ ä¸Šä¸‹æ–‡ï¼Œå°†è¿™ä¸ªä¸Šä¸‹æ–‡ä¼ å…¥è¯·æ±‚å¤„ç†æ–¹æ³•ä¸­ï¼Œä½¿ä¸­é—´ä»¶å‡½æ•°èƒ½å¯¹å…¨å±€ctxè¿›è¡Œæ›´æ”¹ç­‰æ“ä½œ</span></span><br><span class="line">      <span class="keyword">const</span> ctx = <span class="built_in">this</span>.createContext(req, res);</span><br><span class="line">      <span class="comment">// è°ƒç”¨è¯·æ±‚å¤„ç†æ–¹æ³•</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.handleRequest(ctx, fn);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> handleRequest;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// application.js</span></span><br><span class="line">  listen(...args) &#123;</span><br><span class="line">    debug(<span class="string">&#x27;listen&#x27;</span>);</span><br><span class="line">		<span class="keyword">const</span> server = http.createServer(<span class="built_in">this</span>.callback());</span><br><span class="line">    <span class="comment">// æœ€åæ‰§è¡ŒnodeåŸç”Ÿçš„httpçš„server.listenæ–¹æ³•åˆ›å»ºæœåŠ¡å™¨</span></span><br><span class="line">    <span class="keyword">return</span> server.listen(...args);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å¥½å˜ï¼ŒåŸºæœ¬çš„æµç¨‹å°±æ˜¯è¿™æ ·ï¼Œä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºå°±åˆ›å»ºå®Œæˆäº†ã€‚</p>
<blockquote>
<p>æ¥ä¸‹æ¥å°±ä¸»è¦çœ‹ä¸‹è¿™ä¸ªcallbackå‡½æ•°</p>
</blockquote>
<h1 id="æ´‹è‘±æ¨¡å‹ğŸ§…"><a href="#æ´‹è‘±æ¨¡å‹ğŸ§…" class="headerlink" title="æ´‹è‘±æ¨¡å‹ğŸ§…"></a>æ´‹è‘±æ¨¡å‹ğŸ§…</h1><p><img src="https://user-gold-cdn.xitu.io/2020/3/12/170ce29e8797e2ce?imageslim" alt="image-20201118233716030"></p>
<p>æˆ‘ä»¬å…ˆä»è¿™ä¸ªæ´‹è‘±æ¨¡å‹æ¥å…¥æ‰‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">middleware</span>) </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  ä¸Šé¢æ˜¯ä¸€å †åˆ¤æ–­å‡½æ•°ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„ã€é‡Œé¢æ˜¯å¦æ˜¯å‡½æ•°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">context, next</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// last called middleware #</span></span><br><span class="line">      <span class="keyword">let</span> index = <span class="number">-1</span></span><br><span class="line">      <span class="keyword">return</span> dispatch(<span class="number">0</span>)</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= index) <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;next() called multiple times&#x27;</span>))</span><br><span class="line">        index = i</span><br><span class="line">        <span class="keyword">let</span> fn = middleware[i]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å½“æ‰€æœ‰ä¸­é—´ä»¶å‡½æ•°è°ƒç”¨å®Œæˆåï¼Œåªéœ€è¦è¿”å›ä¸€ä¸ªç©ºçš„å‡½æ•°å°±è¡Œï¼Œè¿™é‡Œå°±æ˜¯è¿”å›äº†Promise.resolve()</span></span><br><span class="line">        <span class="keyword">if</span> (i === middleware.length) fn = next</span><br><span class="line">        <span class="keyword">if</span> (!fn) <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve()</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          </span><br><span class="line">          <span class="comment">// è¿™é‡Œè¿›è¡Œé€’å½’è°ƒç”¨ï¼Œæ¯æ¬¡dispatchç»‘å®šçš„å‡½æ•°æˆäº†useå‚æ•°åˆ—è¡¨ä¸­çš„nextå‡½æ•°</span></span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(fn(context, dispatch.bind(<span class="literal">null</span>, i + <span class="number">1</span>)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// koa å®ä¾‹ä¸­çš„è°ƒç”¨</span></span><br><span class="line"><span class="keyword">const</span> fn = compose(middleware); <span class="comment">// middleware: usedFunc[]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//returned---&gt;å°±ç›¸å½“äºä¸‹é¢è¿™ä¸ªæ ·å­</span></span><br><span class="line">equivalentFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(fn1(ctx,</span><br><span class="line">    () =&gt; <span class="built_in">Promise</span>.resolve(fn2(ctx,</span><br><span class="line">        () =&gt; <span class="built_in">Promise</span>.resolve(fn3(ctx,</span><br><span class="line">            () =&gt; <span class="built_in">Promise</span>.resolve()))))))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“appç¨‹åºçœŸæ­£æ³¨å†Œä¹‹åï¼Œå„ä¸­é—´ä»¶å‡½æ•°è¢«æ•´åˆæˆäº†ä¸€å±‚å±‚åµŒå¥—çš„Promise,å½“è¢«è°ƒç”¨çš„æ—¶å€™å°±æˆäº†å‰¥æ´‹è‘±çš„æ ·å­ï¼Œä»å¤–è‡³é‡Œï¼Œåˆä»é‡Œè‡³å¤–ï¼ˆè¿˜æ˜¯å¤§ä½¬ä¼šç©</span></span><br></pre></td></tr></table></figure>



<h1 id="å¤„ç†è¯·æ±‚ğŸ™"><a href="#å¤„ç†è¯·æ±‚ğŸ™" class="headerlink" title="å¤„ç†è¯·æ±‚ğŸ™"></a>å¤„ç†è¯·æ±‚ğŸ™</h1><blockquote>
<p>è¿™éƒ¨åˆ†ä¸»è¦å°±çœ‹è¿™ä¸ªcallbackåé¢çš„åœ°æ–¹</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">callback() &#123;</span><br><span class="line">  <span class="keyword">const</span> fn = compose(<span class="built_in">this</span>.middleware);</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">this</span>.listenerCount(<span class="string">&#x27;error&#x27;</span>)) <span class="built_in">this</span>.on(<span class="string">&#x27;error&#x27;</span>, <span class="built_in">this</span>.onerror);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°±åœ¨è¿™é‡Œäº†</span></span><br><span class="line">  <span class="keyword">const</span> handleRequest = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> ctx = <span class="built_in">this</span>.createContext(req, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.handleRequest(ctx, fn);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> handleRequest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿”å›äº†ä¸€ä¸ªå‡½æ•°ç”¨æ¥åšè¯·æ±‚çš„å¤„ç†å‡½æ•°ï¼š<code>handleRequest</code></p>
<p>å…ˆå°±æ˜¯åˆ›å»ºä¸€ä¸ª<code>ctx</code>ä¿è¯ä¸‹é¢å¤„ç†å‡½æ•°ä¸­å¯¹<code>ctx</code>æ˜¯å½±å“æ•´ä¸ªè¯·æ±‚å®ä¾‹çš„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">createContext(req, res) &#123;</span><br><span class="line">  <span class="comment">// æ³¨æ„ä»–ç»™çš„ctxæ˜¯ç»§æ‰¿åœ¨å…¨å±€çš„ctxä¸‹çš„ï¼ŒåŒ…æ‹¬reqã€resï¼Œéƒ½æ˜¯ç»§æ‰¿åœ¨å…¨å±€çš„reqã€resä¸‹çš„ã€‚</span></span><br><span class="line">  <span class="keyword">const</span> context = <span class="built_in">Object</span>.create(<span class="built_in">this</span>.context);</span><br><span class="line">  <span class="keyword">const</span> request = context.request = <span class="built_in">Object</span>.create(<span class="built_in">this</span>.request);</span><br><span class="line">  <span class="keyword">const</span> response = context.response = <span class="built_in">Object</span>.create(<span class="built_in">this</span>.response);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å¹¶ä¸”å°†å®ä¾‹å¯¹è±¡ï¼ˆappï¼‰åŠreqã€reséƒ½èµ‹åœ¨äº†å„å¯¹è±¡ä¸­</span></span><br><span class="line">  context.app = request.app = response.app = <span class="built_in">this</span>;</span><br><span class="line">  context.req = request.req = response.req = req;</span><br><span class="line">  context.res = request.res = response.res = res;</span><br><span class="line">  request.ctx = response.ctx = context;</span><br><span class="line">  request.response = response;</span><br><span class="line">  response.request = request;</span><br><span class="line">  context.originalUrl = request.originalUrl = req.url;</span><br><span class="line">  context.state = &#123;&#125;;</span><br><span class="line">  <span class="keyword">return</span> context;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»™ä¸ªæ€ç»´å¯¼å›¾å°±æ˜¯è¿™æ ·ï¼š</p>
<p><img src="https://i.loli.net/2020/11/22/xhlGHUS3b1nENea.png" alt="image-20201122001832770"></p>
<p>ä¸»è¦æ¥çœ‹é‡Œé¢çš„<code>this.handleRequest</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">handleRequest(ctx, fnMiddleware) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = ctx.res;</span><br><span class="line">  <span class="comment">// ç®¡ç†è¯·æ±‚çŠ¶æ€</span></span><br><span class="line">  res.statusCode = <span class="number">404</span>;</span><br><span class="line">  <span class="keyword">const</span> onerror = <span class="function"><span class="params">err</span> =&gt;</span> ctx.onerror(err);</span><br><span class="line">  <span class="comment">// å¤„ç†å“åº”çš„å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> handleResponse = <span class="function">() =&gt;</span> respond(ctx);</span><br><span class="line">  <span class="comment">// å“åº”ç»“æŸæ—¶æ‰§è¡Œçš„å‡½æ•°ï¼ˆé”™è¯¯å¤„ç†</span></span><br><span class="line">  onFinished(res, onerror);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å…ˆæ‰§è¡Œä¸­é—´ä»¶å‡½æ•°ï¼Œå†æ‰§è¡Œå“åº”å¤„ç†å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> fnMiddleware(ctx).then(handleResponse).catch(onerror); <span class="comment">// å¹¶ä¸”å¸¦ä¸Šäº†é”™è¯¯å¤„ç†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h1><blockquote>
<p>koaä¸­å¯¹äºé”™è¯¯å¤„ç†ï¼Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·ä½¿ç”¨å°±å¯ä»¥äº†ï¼š</p>
<p>app.on(â€˜errorâ€™, err =&gt; {</p>
<p>â€‹        /* handleError */</p>
<p>})</p>
<p>é‚£ä¹ˆkoaæ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿ</p>
</blockquote>
<p>æ ¸å¿ƒçš„åœ°æ–¹å°±æ˜¯ä¸Šé¢åˆšæåˆ°çš„<code>handleRequest</code>å¤„ç†ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  handleRequest(ctx, fnMiddleware) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = ctx.res;</span><br><span class="line">    res.statusCode = <span class="number">404</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¤„ç†é”™è¯¯çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> onerror = <span class="function"><span class="params">err</span> =&gt;</span> ctx.onerror(err);</span><br><span class="line">    <span class="keyword">const</span> handleResponse = <span class="function">() =&gt;</span> respond(ctx);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å“åº”ç»“æŸæ—¶æ‰§è¡Œçš„å‡½æ•°ï¼ˆé”™è¯¯å¤„ç†</span></span><br><span class="line">    onFinished(res, onerror);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…ˆæ‰§è¡Œä¸­é—´ä»¶å‡½æ•°ï¼Œè¿™é‡Œåœ¨æ‰§è¡Œä¸­é—´ä»¶å‡½æ•°è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦æœ‰é”™è¯¯ï¼Œå®ƒéƒ½èƒ½æ•è·åˆ°</span></span><br><span class="line">    <span class="keyword">return</span> fnMiddleware(ctx).then(handleResponse).catch(onerror);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›é¡¾ä¸‹ä¸­é—´ä»¶å‡½æ•°çš„å¤„ç†</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">middleware</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">context, next</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è¿™ä¸ªåœ°æ–¹ï¼Œä¸€æ—¦æœ‰é”™è¯¯ï¼Œä¾¿ä¼šrejectå‡ºå»</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(fn(context, dispatch.bind(<span class="literal">null</span>, i + <span class="number">1</span>)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æœ‰ä¸€ä¸ªåœ°æ–¹å€¼å¾—æ³¨æ„ï¼Œ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> onerror = <span class="function"><span class="params">err</span> =&gt;</span> ctx.onerror(err);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„<code>onerror</code>å‡½æ•°æ˜¯ç”¨çš„<code>ctx</code>çš„ï¼Œä¸ºä»€ä¹ˆå¯ä»¥åœ¨<code>app</code>ä¸Šç›‘å¬åˆ°å‘¢ï¼Ÿ</p>
<p>å¯ä»¥å»åº·åº·<code>context</code>ğŸ‘€</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸»è¦å°±æ˜¯åœ¨è¿™é‡Œ</span></span><br><span class="line"></span><br><span class="line">onerror(err) &#123;</span><br><span class="line">    <span class="comment">// delegate</span></span><br><span class="line">    <span class="built_in">this</span>.app.emit(<span class="string">&#x27;error&#x27;</span>, err, <span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ƒè¿›è¡Œäº†ä¸€ä¸ªä»£ç†ï¼Œå‘appä¸Šå‘é€äº‹ä»¶ï¼Œè¿›è€Œç”¨appä¸Šçš„onerrorå‡½æ•°æ¥å¤„ç†é”™è¯¯ï¼Œä¹Ÿæ˜¯å› ä¸ºApplicationç±»ç»§æ‰¿è‡ªEmitteræ‰èƒ½åšåˆ°çš„ã€‚</span></span><br></pre></td></tr></table></figure>



<h1 id="okğŸ‘Œç™½ç™½ï½"><a href="#okğŸ‘Œç™½ç™½ï½" class="headerlink" title="okğŸ‘Œç™½ç™½ï½"></a>okğŸ‘Œç™½ç™½ï½</h1>]]></content>
  </entry>
  <entry>
    <title>vue è‡ªå®šä¹‰ç»„ä»¶v-modelåŒå‘ç»‘å®šå’Œçˆ¶å­ç»„ä»¶åŒæ­¥é€šä¿¡</title>
    <url>/2020/10/17/%E8%87%AA%E5%AE%9A%E4%B9%89v-model/</url>
    <content><![CDATA[<h1 id="vue-è‡ªå®šä¹‰ç»„ä»¶v-modelåŒå‘ç»‘å®šå’Œçˆ¶å­ç»„ä»¶åŒæ­¥é€šä¿¡"><a href="#vue-è‡ªå®šä¹‰ç»„ä»¶v-modelåŒå‘ç»‘å®šå’Œçˆ¶å­ç»„ä»¶åŒæ­¥é€šä¿¡" class="headerlink" title="vue è‡ªå®šä¹‰ç»„ä»¶v-modelåŒå‘ç»‘å®šå’Œçˆ¶å­ç»„ä»¶åŒæ­¥é€šä¿¡"></a>vue è‡ªå®šä¹‰ç»„ä»¶v-modelåŒå‘ç»‘å®šå’Œçˆ¶å­ç»„ä»¶åŒæ­¥é€šä¿¡</h1><h2 id="åŸå› å˜›ã€‚ã€‚"><a href="#åŸå› å˜›ã€‚ã€‚" class="headerlink" title="åŸå› å˜›ã€‚ã€‚"></a>åŸå› å˜›ã€‚ã€‚</h2><p>å°±æ˜¯çœ‹vueæ•™ç¨‹æ—¶å€™æ²¡çœ‹æ‡‚ï¼Œæˆ‘ç›´æ¥é˜¿å·´é˜¿å·´ï¼Œ<a href="%5Bhttps://cn.vuejs.org/v2/guide/components-custom-events.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%9A%84-v-model%5D(https://cn.vuejs.org/v2/guide/components-custom-events.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%9A%84-v-model)">è¿™ä¸ª</a></p>
<p>ç„¶åæœäº†ä¸‹ï¼Œè½¬çœ¼ä¸€çœ‹è‡ªå·±åˆåƒä¸ªæ†¨æ‰¹äº†ğŸ¤£</p>
<a id="more"></a>

<h2 id="ç®€å•ä»‹ç»ä¸‹"><a href="#ç®€å•ä»‹ç»ä¸‹" class="headerlink" title="ç®€å•ä»‹ç»ä¸‹"></a>ç®€å•ä»‹ç»ä¸‹</h2><p><code>v-model</code>æŒ‡ä»¤é€šå¸¸ç”¨åœ¨ä¸ç”¨æˆ·äº¤äº’å¡«å†™ç›¸å…³ä¿¡æ¯ä¸Šï¼Œæ¯”å¦‚åœ¨è¡¨å• <code>&lt;input&gt;</code>ã€<code>&lt;textarea&gt;</code> åŠ <code>&lt;select&gt;</code> å…ƒç´ ä¸Šåˆ›å»ºåŒå‘æ•°æ®ç»‘å®šã€‚</p>
<p>æœ¬è´¨ä¸Šå°±æ˜¯ç»‘å®špropçš„è¯­æ³•ç³–ï¼šç»‘å®šæ•°æ®ï¼Œè€Œåè§¦å‘äº‹ä»¶ï¼Œæ›´æ–°æ•°æ®ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰è‡ªå®šä¹‰modelè¿™æ ·çš„æ“ä½œå‘¢ï¼Œæ˜¯å› ä¸ºï¼Œ<code>v-model</code>åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œç»‘å®šçš„propæ˜¯valueï¼Œè§¦å‘çš„äº‹ä»¶æ˜¯inputï¼Œå…·ä½“æ¥è®²å°±æ˜¯</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// v-model</span></span><br><span class="line">&lt;custom-input v-model=<span class="string">&quot;test&quot;</span>&gt;&lt;/custom-input&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ¬è´¨ä¸Š</span></span><br><span class="line">&lt;custom-input :value=<span class="string">&quot;test&quot;</span> @input=<span class="string">&quot;value =&gt; test = value&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">custom-input</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ‰€ä»¥å˜ï¼Œä¸€ä¸ªè‡ªå®šä¹‰çš„<code>v-model</code>ç»„ä»¶ä¸­å°±æ˜¯è‡ªå®šä¹‰æ¥å—çš„æ•°æ®æ˜¯å•¥ï¼Œè‡ªå®šä¹‰è§¦å‘çš„äº‹ä»¶æ˜¯å•¥ã€‚</p>
</blockquote>
<p>vueåŸæ–‡ï¼š</p>
<blockquote>
<p><a href="https://cn.vuejs.org/v2/guide/components-custom-events.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%9A%84-v-model">è‡ªå®šä¹‰ç»„ä»¶çš„ <code>v-model</code></a></p>
<p>â€‹    2.2.0+ æ–°å¢</p>
<p>ä¸€ä¸ªç»„ä»¶ä¸Šçš„ <code>v-model</code> é»˜è®¤ä¼šåˆ©ç”¨åä¸º <code>value</code> çš„ prop å’Œåä¸º <code>input</code> çš„äº‹ä»¶ï¼Œä½†æ˜¯åƒå•é€‰æ¡†ã€å¤é€‰æ¡†ç­‰ç±»å‹çš„è¾“å…¥æ§ä»¶å¯èƒ½ä¼šå°† <code>value</code> attribute ç”¨äº<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/checkbox#Value">ä¸åŒçš„ç›®çš„</a>ã€‚</p>
</blockquote>
<h2 id="æ¥äº†æ¥äº†ï¼Œå®æ“è®²è§£äº†ï¼ˆv-modelé€šä¿¡ï¼‰"><a href="#æ¥äº†æ¥äº†ï¼Œå®æ“è®²è§£äº†ï¼ˆv-modelé€šä¿¡ï¼‰" class="headerlink" title="æ¥äº†æ¥äº†ï¼Œå®æ“è®²è§£äº†ï¼ˆv-modelé€šä¿¡ï¼‰"></a>æ¥äº†æ¥äº†ï¼Œå®æ“è®²è§£äº†ï¼ˆ<code>v-model</code>é€šä¿¡ï¼‰</h2><h3 id="å†™æ³•ä¸€ï¼ˆæ¨èï¼‰"><a href="#å†™æ³•ä¸€ï¼ˆæ¨èï¼‰" class="headerlink" title="å†™æ³•ä¸€ï¼ˆæ¨èï¼‰"></a>å†™æ³•ä¸€ï¼ˆæ¨èï¼‰</h3><p>è¿™é‡Œå°±è§£é‡Šä¸‹vueå®˜æ–¹æ•™ç¨‹ä¸­çš„ä¾‹å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„v-modelç»„ä»¶</span></span><br><span class="line">Vue.component(<span class="string">&#x27;base-checkbox&#x27;</span>, &#123;</span><br><span class="line">  model: &#123;</span><br><span class="line">    prop: <span class="string">&#x27;checked&#x27;</span>, <span class="comment">// è¿™ä¸ªpropï¼š checkedï¼Œå°±æ˜¯è‡ªå®šä¹‰çš„propã€‚æ˜¯åœ¨è¯¥ç»„ä»¶è¢«è°ƒç”¨æ—¶ç”¨v-modelè·å–åˆ°çš„å€¼ï¼Œå³ä¸‹é¢è°ƒç”¨è¯¥ç»„ä»¶æ—¶ç”¨v-modelä¼ å…¥çš„lovingvue, å¯ä»¥è¿™æ ·ç†è§£ï¼Œè¯¥ç»„ä»¶å°†å¤–é¢v-modelä¼ å…¥çš„å€¼ç”¨checkedè¿™ä¸ªpropæ¥æ¥æ”¶ã€‚</span></span><br><span class="line">    event: <span class="string">&#x27;change&#x27;</span>  <span class="comment">// è¿™ä¸ªeventï¼š changeï¼Œå°±æ˜¯è‡ªå®šä¹‰çš„è§¦å‘äº‹ä»¶ã€‚è§¦å‘è¯¥äº‹ä»¶æ—¶ï¼Œæ›´æ–°çš„å€¼å°±ä¼šè‡ªåŠ¨æ›´æ–°ç»™v-modelç»‘å®šçš„å€¼ã€‚ç”¨ä¸‹é¢ä½¿ç”¨çš„å®ä¾‹æ¥è¯´ï¼Œå°±æ˜¯ï¼Œåœ¨å­ç»„ä»¶base-checkboxè§¦å‘è‡ªèº«çš„changeäº‹ä»¶æ—¶ï¼Œè¿™æ—¶ä¼šæ‰§è¡Œ$emit(&#x27;change&#x27;, $event.target.checked)ï¼Œ é‚£ä¹ˆå°±æ˜¯è¯´è§¦å‘äº†çˆ¶ç»„ä»¶çš„changeäº‹ä»¶ï¼Œæ­¤æ—¶æºå¸¦çš„å‚æ•°ï¼Œ $event.target.checkedä¼šè‡ªåŠ¨èµ‹å€¼ç»™v-modelæ‰€ç»‘å®šçš„lovingvueè¿™ä¸ªå˜é‡ï¼Œå®ç°æ•°æ®æ›´æ–°ã€‚</span></span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    checked: <span class="built_in">Boolean</span> <span class="comment">// ä¸Šé¢çš„modelå¯¹è±¡æ˜¯å¯¹v-modelçš„è‡ªå®šä¹‰ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦åœ¨propsä¸­å£°æ˜ checked è¿™ä¸ª propã€‚</span></span><br><span class="line">  &#125;,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input</span></span><br><span class="line"><span class="string">      type=&quot;checkbox&quot;</span></span><br><span class="line"><span class="string">      v-bind:checked=&quot;checked&quot; // å°†prop: checkedç»‘å®šåˆ° inputæ ‡ç­¾ä¸Šçš„attr: checkedä¸Š</span></span><br><span class="line"><span class="string">      v-on:change=&quot;$emit(&#x27;change&#x27;, $event.target.checked)&quot; // changeäº‹ä»¶è§¦å‘æ—¶ï¼Œè§¦å‘çˆ¶ç»„ä»¶è‡ªå®šä¹‰çš„changeäº‹ä»¶ï¼Œå¹¶ä¼ å…¥æ›´æ–°åçš„å€¼</span></span><br><span class="line"><span class="string">    &gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶</span></span><br><span class="line">&lt;base-checkbox v-model=<span class="string">&quot;lovingVue&quot;</span>&gt;&lt;/base-checkbox&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªä¾‹å­ä¸­å¯èƒ½å„ç§propä¸attråç§°ä¸€æ ·ï¼Œçœ‹çš„æœ‰ç‚¹è¿·ç³Šï¼Œæˆ‘ä¸‹é¢å°±æ”¹ä¸€ä¸‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„v-modelç»„ä»¶</span></span><br><span class="line">Vue.component(<span class="string">&#x27;base-checkbox&#x27;</span>, &#123;</span><br><span class="line">  model: &#123;</span><br><span class="line">    prop: <span class="string">&#x27;propChecked&#x27;</span>, <span class="comment">// è‡ªå®šä¹‰çš„prop</span></span><br><span class="line">    event: <span class="string">&#x27;emit-change-event&#x27;</span> <span class="comment">// è‡ªå®šä¹‰çš„v-modelç»‘å®šè§¦å‘äº‹ä»¶</span></span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    propChecked: <span class="built_in">Boolean</span> <span class="comment">// ä»éœ€è¦å£°æ˜æ¥å—çš„prop</span></span><br><span class="line">  &#125;,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input</span></span><br><span class="line"><span class="string">      type=&quot;checkbox&quot;</span></span><br><span class="line"><span class="string">      v-bind:checked=&quot;propChecked&quot;</span></span><br><span class="line"><span class="string">      v-on:change=&quot;$emit(&#x27;emit-change-event&#x27;, $event.target.checked)&quot; // è¿™é‡Œè§¦å‘çˆ¶ç»„ä»¶çš„v-modelç»‘å®šçš„äº‹ä»¶</span></span><br><span class="line"><span class="string">    &gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶</span></span><br><span class="line">&lt;base-checkbox v-model=<span class="string">&quot;lovingVue&quot;</span>&gt;&lt;/base-checkbox&gt;</span><br></pre></td></tr></table></figure>

<h3 id="å†™æ³•äºŒ"><a href="#å†™æ³•äºŒ" class="headerlink" title="å†™æ³•äºŒ"></a>å†™æ³•äºŒ</h3><p>ä¹‹å‰æåˆ°<code>v-model</code>é»˜è®¤ç»‘å®šçš„propæ˜¯valueï¼Œé»˜è®¤ç»‘å®šçš„è§¦å‘äº‹ä»¶æ˜¯inputã€‚</p>
<p>æ‰€ä»¥å†™æ³•äºŒä¹Ÿå°±å¾ˆæ˜äº†å’¯ã€‚</p>
<p>è¿™é‡Œæ­£å¥½å¯ä»¥å¯¹æ¯”ä¸‹ï¼Œå°±æ”¹å†™ä¸Šé¢vueå®˜æ–¹çš„ä¾‹å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„v-modelç»„ä»¶</span></span><br><span class="line">Vue.component(<span class="string">&#x27;base-checkbox&#x27;</span>, &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    value: &#123; <span class="comment">// è¿™é‡Œæ˜¾å¼åœ°ç”¨é»˜è®¤çš„propvalueæ¥æ¥æ”¶</span></span><br><span class="line">		<span class="keyword">default</span>: <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input</span></span><br><span class="line"><span class="string">      type=&quot;checkbox&quot;</span></span><br><span class="line"><span class="string">      v-bind:checked=&quot;value&quot;</span></span><br><span class="line"><span class="string">      v-on:change=&quot;$emit(&#x27;input&#x27;, $event.target.checked)&quot; // è¿™é‡Œè§¦å‘é»˜è®¤ç»‘å®šäº‹ä»¶input</span></span><br><span class="line"><span class="string">    &gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶æ—¶</span></span><br><span class="line">&lt;base-checkbox v-model=<span class="string">&quot;lovingVue&quot;</span>&gt;&lt;/base-checkbox&gt;</span><br></pre></td></tr></table></figure>



<p>å»ºè®®ä½¿ç”¨å†™æ³•ä¸€ï¼Œä¸ç„¶æ€ä¹ˆå«è‡ªå®šä¹‰å˜›ï¼Œå¯¹å§ğŸ˜</p>
<p>ä»¥ä¸Šä¾¿æ˜¯å°ç”Ÿå¯¹æ­¤ä¸€æ‹™è§ã€‚</p>
<p>refï¼š <a href="http://www.dongxiaofeng.com/2019/02/18/vue-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6v-model%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E5%92%8C%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E5%90%8C%E6%AD%A5%E9%80%9A%E4%BF%A1/">http://www.dongxiaofeng.com/2019/02/18/vue-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6v-model%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E5%92%8C%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E5%90%8C%E6%AD%A5%E9%80%9A%E4%BF%A1/</a></p>
]]></content>
  </entry>
  <entry>
    <title>é‡æ‹¾JS(ä¸€)--æµ…è°ˆnewå’Œthis</title>
    <url>/2020/10/28/%E9%87%8D%E6%8B%BEJS(%E4%B8%80)/</url>
    <content><![CDATA[<h1 id="é‡æ‹¾JS-ä¸€-â€“æµ…è°ˆnewå’Œthis"><a href="#é‡æ‹¾JS-ä¸€-â€“æµ…è°ˆnewå’Œthis" class="headerlink" title="é‡æ‹¾JS(ä¸€)â€“æµ…è°ˆnewå’Œthis"></a>é‡æ‹¾JS(ä¸€)â€“æµ…è°ˆnewå’Œthis</h1><h2 id="newæ“ä½œç¬¦"><a href="#newæ“ä½œç¬¦" class="headerlink" title="newæ“ä½œç¬¦"></a><code>new</code>æ“ä½œç¬¦</h2><p>æˆ‘ä»¬åœ¨å­¦ä¹ ç¼–ç¨‹æ—¶åº”è¯¥éƒ½ä¼šæ¥è§¦åˆ°OOPç¼–ç¨‹èŒƒå¼ï¼Œè€Œå¯¹äºJSè¿™é—¨è¯­è¨€æ¥è¯´ï¼ŒJSæ˜¯ä¸€é—¨å¤šèŒƒå¼ç¼–ç¨‹è¯­è¨€ï¼Œå‘½ä»¤å¼ã€å‡½æ•°å¼ä»¥åŠé¢å‘å¯¹è±¡ã€‚</p>
<p>è€Œnewåœ¨JSä¸­çš„ä½œç”¨å°±æ˜¯ï¼šæ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè¿™ä¸€éƒ¨åˆ†å°±ä¸é¢å‘å¯¹è±¡ç›¸å…³äº†ã€‚</p>
<h3 id="é¢å‘å¯¹è±¡çš„å¯¹è±¡æ˜¯å•¥å˜ï¼ŸğŸ¤”"><a href="#é¢å‘å¯¹è±¡çš„å¯¹è±¡æ˜¯å•¥å˜ï¼ŸğŸ¤”" class="headerlink" title="é¢å‘å¯¹è±¡çš„å¯¹è±¡æ˜¯å•¥å˜ï¼ŸğŸ¤”"></a>é¢å‘å¯¹è±¡çš„å¯¹è±¡æ˜¯å•¥å˜ï¼ŸğŸ¤”</h3><p>å¯¹è±¡â€”&gt;Objectï¼Œä¸åŒäºJSä¸­çš„æ•°æ®ç±»å‹Objectï¼Œä½œä¸ºOOPç¼–ç¨‹èŒƒå¼ä¸­çš„ä¸»ä½“ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸¤ä¸ªå±‚æ¬¡å»ç†è§£ï¼š</p>
<ul>
<li><p><strong>å¯¹è±¡æ˜¯æŸå®ç‰©çš„æŠ½è±¡åŒ–å•å…ƒã€‚</strong></p>
<p>ä¸€ä¸ªäººã€ä¸€æ£µæ ‘ã€ä¸€é—´æˆ¿å­ï¼Œå‡å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå½“æˆ‘ä»¬æŠŠå®ƒæŠ½è±¡å‡ºæ¥ï¼Œä¾‹å¦‚å®ƒä»…ä»…æ˜¯æ£µæ ‘ï¼Œå®ƒçš„æ ‘é¾„ï¼Œå®ƒçš„ç§‘å±å‡å±äºè¿™ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œè€Œå¤šæ£µæ ‘å‘¢å°±æ˜¯å¤šä¸ªæ ‘å¯¹è±¡ç½¢äº†ã€‚</p>
</li>
<li><p><strong>å¯¹è±¡æ˜¯ä¸ªåŒ…è£…äº†å±æ€§(property)å’Œæ–¹æ³•(method)çš„ç›’å­ã€‚</strong></p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠä»»æ„ä¸€ä¸ªäº‹ç‰©æŠ½è±¡æˆå®ƒçš„çŠ¶æ€(property)å’Œè¡Œä¸º(method)çš„é›†åˆã€‚ä¾‹å¦‚ï¼Œè¿˜å°†ä¸Šè¿°çš„æ ‘ä½œä¾‹å­å§ï¼Œå®ƒçš„æ ‘é¾„å°±æ˜¯å®ƒçš„å±æ€§ï¼Œå®ƒçš„ç§‘å±ä¹Ÿæ˜¯å®ƒçš„å±æ€§ï¼Œè€Œå®ƒå¯ä»¥è¿›è¡Œå…‰åˆä½œç”¨è¿™ä¸€è¡Œä¸ºçš„èƒ½åŠ›å°±æ˜¯å®ƒçš„æ–¹æ³•ï¼Œå®ƒè¿›è¡Œå‘¼å¸ä½œç”¨è¿™ä¸€è¡Œä¸ºçš„èƒ½åŠ›ä¹Ÿæ˜¯å®ƒçš„æ–¹æ³•ã€‚   ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå±æ€§å¯ä»¥æœ‰å¤šä¸ªï¼Œæ–¹æ³•ä¹Ÿä¸€æ ·å¯ä»¥æœ‰å¤šä¸ªã€‚</p>
</li>
</ul>
<h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><p>è¦æƒ³å®è¡ŒOOPï¼Œå°‘ä¸äº†å¯¹è±¡å˜›ã€‚å¯¹è±¡ä½œä¸ºä¸€ä¸ªå®ç‰©çš„æŠ½è±¡å•å…ƒï¼Œåœ¨JSä¸­éœ€è¦é€šè¿‡æ‰§è¡Œæ„é€ å‡½æ•°(constructor)æ¥ç”Ÿæˆå¯¹è±¡ï¼Œè¿™é‡Œä¸åšè¿‡å¤šä»‹ç»ï¼Œä»…è¯´æ˜ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p>
<blockquote>
<ul>
<li>å‡½æ•°ä½“å†…éƒ¨å¯ä½¿ç”¨<code>this</code>å…³é”®å­—ï¼ŒæŒ‡å‘å‡½æ•°ç”Ÿæˆçš„å¯¹è±¡å®ä¾‹ã€‚</li>
<li>ç”Ÿæˆå¯¹è±¡å¿…é¡»ä½¿ç”¨<code>new</code>å‘½ä»¤</li>
</ul>
</blockquote>
<h3 id="æ²¡æœ‰å¯¹è±¡ï¼Ÿnewä¸€ä¸ªï¼â˜ºï¸"><a href="#æ²¡æœ‰å¯¹è±¡ï¼Ÿnewä¸€ä¸ªï¼â˜ºï¸" class="headerlink" title="æ²¡æœ‰å¯¹è±¡ï¼Ÿnewä¸€ä¸ªï¼â˜ºï¸"></a>æ²¡æœ‰å¯¹è±¡ï¼Ÿ<code>new</code>ä¸€ä¸ªï¼â˜ºï¸</h3><p>ç”Ÿæˆä¸€ä¸ªå¯¹è±¡<code>new</code>ä¸€ä¸ªå°±è¡Œäº†ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// constructor function</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">People</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line"><span class="meta">  &#x27;use strict&#x27;</span>;</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create object instance</span></span><br><span class="line"><span class="keyword">const</span> xingjiejie = <span class="keyword">new</span> People(<span class="string">&#x27;xingjiejie&#x27;</span>, <span class="number">18</span>)</span><br></pre></td></tr></table></figure>

<p>å°æä¸€å¥ï¼š<code>new</code>å‘½ä»¤æœ¬èº«å°±å¯ä»¥æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå°±æ˜¯è¯´å‡½æ•°åé¢å¯ä»¥ä¸å¸¦æ‹¬å·ï¼Œä¸è¿‡æ¨èåŠ ä¸Šæ‹¬å·ã€‚</p>
<p>æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯æ—¢ç„¶è¿™ä¸ªæ„é€ å‡½æ•°è·Ÿå¹³å¸¸çš„å‡½æ•°æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œé‚£ä¹ˆä¸ä½¿ç”¨<code>new</code>ä¼šæ€ä¹ˆæ ·å‘¢ï¼Œè¿™ä¸ªæ—¶å€™å¹¶ä¸ä¼šç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œè€Œä¸”ï¼Œå¦‚æœæ„é€ å‡½æ•°ä¸­æœ‰èµ‹ç»™thisçš„å±æ€§è¯ï¼Œè¿™äº›å±æ€§ä¼šèµ‹ç»™å…¨å±€å¯¹è±¡ä¸Šï¼Œè¿™ä¸ªåŸå› æ”¾åœ¨åé¢è®²ã€‚ä¸ºäº†é¿å…å¯¼è‡´è¿™æ ·çš„é—®é¢˜å‘ç”Ÿï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“ä¸­åŠ ä¸Š    â€˜use strictâ€™    ï¼Œè¿è¡Œæ—¶ä¸ç”¨newè°ƒç”¨ä¾¿ä¼šæŠ¥é”™ã€‚</p>
<h3 id="newåˆ°åº•æ˜¯ä¸ªå•¥ï¼ŸğŸ˜"><a href="#newåˆ°åº•æ˜¯ä¸ªå•¥ï¼ŸğŸ˜" class="headerlink" title="newåˆ°åº•æ˜¯ä¸ªå•¥ï¼ŸğŸ˜"></a><code>new</code>åˆ°åº•æ˜¯ä¸ªå•¥ï¼ŸğŸ˜</h3><p><strong>ä¸‹é¢æ¥ä»‹ç»ä¸‹<code>new</code>å‘½ä»¤çš„åŸç†ï¼š</strong></p>
<p>ä»–ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½œä¸ºå°†è¦è¿”å›çš„å¯¹è±¡å®ä¾‹ã€‚</li>
<li>æ”¹å˜ç©ºå¯¹è±¡åŸå‹ä¸ºæ„é€ å‡½æ•°çš„åŸå‹ï¼š<code>prototype</code></li>
<li>å°†thisæŒ‡é’ˆæŒ‡å‘è¯¥ç©ºå¯¹è±¡ã€‚</li>
<li>æ‰§è¡Œæ„é€ å‡½æ•°ã€‚</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ„é€ å‡½æ•°ä¸­çš„thisï¼Œå…¶å®æŒ‡çš„æ˜¯å¦å¤–é‡æ–°ç”Ÿæˆçš„ç©ºå¯¹è±¡ï¼Œå¯ä¸è¦ä»¥ä¸ºæ˜¯é‚£ä¸ªå‡½æ•°å“ŸğŸ‘…</p>
<p>æ³¨æ„ä¸€ç‚¹ï¼Œå¦‚æœæ„é€ å‡½æ•°å†…éƒ¨æœ‰<code>return</code>è¯­å¥ï¼Œ<strong>è€Œä¸”<code>return</code>äº†ä¸€ä¸ªå¯¹è±¡</strong>ï¼Œé‚£ä¹ˆ<code>new</code>æ“ä½œååˆ›å»ºçš„å¯¹è±¡æ˜¯è¿™ä¸ª<code>return</code>è¿”å›çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å†…éƒ¨é‡æ–°åˆ›å»ºçš„ç©ºå¯¹è±¡ã€‚å¦åˆ™ä»è¿”å›<code>this</code>å¯¹è±¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> Animal(<span class="string">&#x27;dog&#x27;</span>) === <span class="string">&#x27;dog&#x27;</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Tree</span>(<span class="params">height</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.height = height;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    height: <span class="number">1988</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> Tree(<span class="number">2001</span>)).height === <span class="number">1988</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢ç®€å•çš„æ‰‹å†™ä¸€ä¸ª<code>new</code>çš„å‡½æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_new</span> (<span class="params">constructor, ...params</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºç©ºå¯¹è±¡å°†å…¶åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„æ˜¾å¼åŸå‹</span></span><br><span class="line">  <span class="keyword">const</span> ctx = <span class="built_in">Object</span>.create(constructor.prototype);</span><br><span class="line">  <span class="comment">// æ‰§è¡Œæ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> res = constructor.apply(ctx, params);</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">typeof</span> res === <span class="string">&#x27;object&#x27;</span> &amp;&amp; res != <span class="literal">null</span>) ? res : ctx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="thiså…³é”®å­—"><a href="#thiså…³é”®å­—" class="headerlink" title="thiså…³é”®å­—"></a><code>this</code>å…³é”®å­—</h2><blockquote>
<p>è¿™ä¸ª<code>this</code>é¸­ï¼Œä½œä¸ºJSåŸºç¡€çš„ä¸‰åº§å¤§å±±ä¹‹ä¸€ï¼Œå¯ä»¥è¯´é“çš„ä¸œè¥¿è¿˜æ˜¯ä¸å°‘çš„ï¼Œè¿™é‡Œæœ¬äººåšä¸€äº›æµ…æï¼Œå¦‚æœ‰é”™è¯¯æˆ–ä¸è¶³ï¼Œæ¬¢è¿æŒ‡æ­£ğŸ˜Š</p>
</blockquote>
<p>JSä¸­<code>this</code>çš„é—®é¢˜è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œå¦‚æœåœ¨å¤æ‚ç¯å¢ƒä¸­ä¸èƒ½åšå¥½å¯¹<code>this</code>çš„å¤„ç†ï¼Œå¾ˆå®¹æ˜“å‡ºç°æ··ä¹±çš„æƒ…å†µï¼Œé€ æˆéš¾ä»¥é¢„æ–™çš„åæœï¼Œä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒTSä¸­ä¹Ÿå¯¹<code>this</code>è¿›è¡Œäº†ç›¸åº”çš„ç±»å‹æ ‡å®šï¼Œå½“ç„¶è¿™éƒ½æ˜¯åè¯äº†ã€‚</p>
<h3 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h3><p>ä¸Šé¢çš„JSçš„OOPå®ç°ä¸­æåˆ°<code>this</code>ç”¨åœ¨æ„é€ å‡½æ•°ä¸­è¡¨ç¤ºçš„æ˜¯æ–°åˆ›å»ºçš„ç©ºå¯¹è±¡ã€‚ä¸ä»…å¦‚æ­¤ï¼Œ<code>this</code>çš„ä½¿ç”¨åœºæ™¯è¿˜æ˜¯å¾ˆå¤šçš„ã€‚ä½†å®ƒçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹å°±æ˜¯ï¼š ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡Objectã€‚</p>
<p><code>this</code>å®ƒè¡¨ç¤ºçš„æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç®€å•æ¥è®²å°±æ˜¯å­—é¢æ„æ€hhï¼š â€˜è¿™ä¸ªï¼Œè¿™é‡Œï¼Œè¿™â€™  ï¼Œè¡¨ç¤ºå®ƒæ‰€åœ¨çš„åœ°æ–¹æ˜¯å“ªé‡Œï¼Œ<strong>åœ¨JSä¸­å°±æ˜¯è¯´å®ƒæ‰€åœ¨çš„å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Œè¡¨ç¤ºä¸ºå®ƒæ‰€åœ¨çš„å¯¹è±¡ã€‚</strong>åœ¨å®ƒè¢«åˆ›é€ å‡ºæ¥ä¹‹åˆçš„å«ä¹‰ä¾¿æ˜¯å¦‚æ­¤ï¼Œè‡³äºåæ¥å†’å‡ºæ¥çš„å„ç§<code>this</code>ç›¸å…³çš„æœ‰è¿é€»è¾‘çš„é—®é¢˜ææ€•ä¹Ÿæ˜¯æœ€å¼€å§‹ä½œè€…æœªæ›¾æƒ³åˆ°çš„å§ï¼Œæ¯•ç«ŸJSä¹Ÿåªä¸è¿‡æ˜¯15å¤©åˆ›é€ å‡ºæ¥çš„å‘¢ğŸ˜…</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name: <span class="string">&#x27;å¼ ä¸‰&#x27;</span>,</span><br><span class="line">  desc: <span class="string">&#x27;æ³•å¤–ç‹‚å¾’&#x27;</span>,</span><br><span class="line">  describe: <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name + <span class="string">&#x27;æ˜¯&#x27;</span> + <span class="built_in">this</span>.desc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">person.describe() <span class="comment">// å¼ ä¸‰æ˜¯æ³•å¤–ç‹‚å¾’</span></span><br></pre></td></tr></table></figure>



<p>è¿™é‡Œçš„å®ä¾‹æš‚æ—¶è¿˜æ˜¯å¾ˆå®¹æ˜“ç†è§£çš„ï¼Œåé¢çš„ä¸€äº›ç•¥éªšçš„æ“ä½œå°±è¦æ¥äº†ï½</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">  desc: <span class="string">&#x27;I\&#x27;m a&#x27;</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> b = &#123;</span><br><span class="line">  desc: <span class="string">&#x27;I\&#x27;m b&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">b.say = a.say;</span><br><span class="line">b.say(); <span class="comment">// I&#x27;m b</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒæŠŠa çš„<code>say</code>æ–¹æ³•èµ‹ç»™äº†bï¼Œ é€šè¿‡<code>b.say()</code>è¿™æ ·çš„æ–¹æ³•å»è°ƒç”¨<code>say</code>æ–¹æ³•ï¼Œæœ€ç»ˆè¿”å›çš„ç»“æœä¸­çš„<code>this</code>å˜æˆäº† b è¿™ä¸ªå¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJSä¸­ï¼Œå¯¹è±¡çš„å±æ€§èµ‹ç»™å¦ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œé‚£è¿™ä¸ªå±æ€§æ‰€åœ¨çš„å¯¹è±¡ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼Œçªå‡ºè¡¨ç°ä¸º<code>this</code>çš„æŒ‡å‘é—®é¢˜ï¼Œ<code>this</code>çš„æŒ‡å‘æ˜¯ä¼šå˜åŒ–çš„ã€‚</p>
<p><strong>è°¨è®°ä¸€ç‚¹ï¼Œ<code>this</code>     çš„æ„æ€ï¼šå®ƒæ‰€åœ¨çš„å¯¹è±¡æ˜¯å•¥ã€‚</strong></p>
<h3 id="thisçš„å®è´¨é—®é¢˜"><a href="#thisçš„å®è´¨é—®é¢˜" class="headerlink" title="thisçš„å®è´¨é—®é¢˜"></a><code>this</code>çš„å®è´¨é—®é¢˜</h3><p>é€šè¿‡æŸ¥é˜…èµ„æ–™ï¼šæœ‰å¦‚ä¸‹è¯´æ˜</p>
<p>JSä¸¤ç§ä¹‹æ‰€ä»¥æœ‰<code>this</code>çš„è®¾è®¡ï¼Œè·Ÿå†…å­˜ä¸­çš„æ•°æ®ç»“æ„æœ‰å…³ã€‚</p>
<p>JSä¸­ä¸€åˆ‡çš†å¯¹è±¡ï¼Œæ‰§è¡Œä»£ç æ—¶ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  num : <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒJSå¼•æ“ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶å°†è¯¥å¯¹è±¡çš„åœ°å€ä½œä¸ºåŸå§‹ç±»å‹çš„å€¼èµ‹ç»™å˜é‡objï¼Œå¦‚éœ€è®¿é—®objï¼Œå¼•æ“ä¼šé€šè¿‡objæ‰€å­˜å‚¨çš„åœ°å€å»è®¿é—®é‚£ä¸ªå¯¹è±¡ã€‚</p>
<p>è€Œä¸”å¯¹äºå¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§ï¼Œæ¯ä¸ªå±æ€§éƒ½æ˜¯ä¸€ä¸ª å±æ€§æè¿°æ€§å¯¹è±¡ ã€‚</p>
<p>å¦‚ä¸‹ä»£ç è¡¨ç¤ºobjå¯¹è±¡å¯èƒ½ä¼šç›´è§‚ä¸€ç‚¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  num : &#123;</span><br><span class="line">    value: <span class="number">0</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    writable: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“å¯¹è±¡çš„å±æ€§æ˜¯ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œåªæ˜¯æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ç½¢äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§çš„å€¼ä¹Ÿæ˜¯ä¸€ä¸ªåœ°å€ï¼Œè®¿é—®çš„æ—¶å€™ä¼šæ ¹æ®è¿™ä¸ªåœ°å€å»è°ƒç”¨å‡½æ•°ã€‚</p>
<p>é‚£ä¹ˆå‡½æ•°ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œå®ƒå°±æ„å‘³ç€å®ƒå¯ä»¥é€šè¿‡è¿™ä¸ªåœ°å€åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡(<code>context</code>)ä¸­è¿è¡Œã€‚</p>
<p>é‚£ä¹ˆå½“è°ƒç”¨çš„ç¯å¢ƒå¾ˆå¤šå¾ˆå¤æ‚çš„æ—¶å€™ï¼Œå‡½æ•°å¦‚ä½•å»åˆ¤æ–­è‡ªå·±è¿è¡Œæ—¶æ‰€å¤„çš„ç¯å¢ƒå‘¢ï¼Œ<code>this</code>å°±æ˜¯è¿™æ ·æ¥çš„ï¼Œç”¨æ¥è¡¨ç¤ºå‡½æ•°è¿è¡Œæ—¶æ‰€å¤„çš„ä¸Šä¸‹æ–‡(<code>context</code>)ã€‚</p>
<h3 id="thisè¿è¡Œæ—¶ç¯å¢ƒ"><a href="#thisè¿è¡Œæ—¶ç¯å¢ƒ" class="headerlink" title="thisè¿è¡Œæ—¶ç¯å¢ƒ"></a><code>this</code>è¿è¡Œæ—¶ç¯å¢ƒ</h3><h4 id="å…¨å±€ç¯å¢ƒ"><a href="#å…¨å±€ç¯å¢ƒ" class="headerlink" title="å…¨å±€ç¯å¢ƒ"></a>å…¨å±€ç¯å¢ƒ</h4><p>è¿™é‡Œç®€å•ç‚¹å¯ä»¥åˆ†<code>æµè§ˆå™¨</code>ç¯å¢ƒå’Œ<code>node</code>ç¯å¢ƒï¼Œ<code>æµè§ˆå™¨</code>ä¸­å…¨å±€å¯¹è±¡ä¸º<code>window</code>ï¼Œ <code>node</code>ä¸­å…¨å¯¹è±¡ä¸º<code>globalã€‚</code></p>
<p>ps. è¿™é‡Œåº”è¯¥ä½œè€…å°šæœªä¿®è¡¥çš„ä¸€ä¸ªå°å‘ã€‚</p>
<h4 id="æ„é€ å‡½æ•°-1"><a href="#æ„é€ å‡½æ•°-1" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><p><code>this</code>æŒ‡çš„æ˜¯åˆ›å»ºçš„ç©ºå¯¹è±¡Objectã€‚</p>
<h4 id="å¯¹è±¡çš„æ–¹æ³•"><a href="#å¯¹è±¡çš„æ–¹æ³•" class="headerlink" title="å¯¹è±¡çš„æ–¹æ³•"></a>å¯¹è±¡çš„æ–¹æ³•</h4><p><code>this</code>æŒ‡å‘æ˜¯æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ç¨å¾®æ³¨æ„ä¸‹æ–¹æ³•æ”¹å˜ç¯å¢ƒæ—¶ï¼Œ<code>this</code>ä¹Ÿä¼šæ”¹å˜ã€‚</p>
<p>ä¸‹é¢ç»™äº›<code>this</code>æŒ‡å‘æ”¹å˜çš„æƒ…å†µï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œ</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  _this: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(obj._this = obj._this)() <span class="comment">// Window</span></span><br><span class="line"></span><br><span class="line">(<span class="literal">false</span> || obj._this)() <span class="comment">// Window</span></span><br><span class="line"></span><br><span class="line">(<span class="number">1</span>, obj._this)() <span class="comment">// Window</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œå½“è°ƒç”¨<code>obj._this</code>è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™å®ƒçš„ç¯å¢ƒå·²ç»å˜æˆäº†å…¨å±€ç¯å¢ƒã€‚</p>
<p>å¯ä»¥è¿™æ ·è®¤ä¸ºï¼šæ­£å¸¸è°ƒç”¨<code>obj._this()</code>æ˜¯ä»å…¨å±€æ‰¾åˆ°objçš„åœ°å€ï¼Œå†ä»objçš„åœ°å€å»æ‰¾<code>_this</code>æ–¹æ³•çš„åœ°å€ï¼Œé‚£ä¹ˆå®ƒçš„è¿è¡Œç¯å¢ƒå°±æ˜¯objçš„åœ°å€ï¼Œè€Œä¸Šè¿°ä»£ç ä¾‹å­ä¸­æ˜¯ç›´æ¥ä»å…¨å±€å‡ºå‘å»æ‰¾<code>_this</code>çš„åœ°å€ï¼Œé‚£ä¹ˆå®ƒä»¬çš„è¿è¡Œç¯å¢ƒæ˜¯å…¨å±€ç¯å¢ƒã€‚</p>
<p>ç­‰åŒäºä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">(<span class="literal">false</span> || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">(<span class="number">1</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>



<p>è¿˜æœ‰å¯èƒ½å‡ºç°å¯¹è±¡åµŒå¥—çš„æƒ…å†µï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> o1 = &#123;</span><br><span class="line">  num: <span class="number">1</span>,</span><br><span class="line">  o2: &#123;</span><br><span class="line">    say: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.num)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">o1.o2.say() <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>this</code>æ‰€åœ¨çš„æ–¹æ³•åœ¨å¯¹è±¡<code>o2</code>ä¸­ï¼Œæ‰€ä»¥æ‰“å°çš„ç»“æœæ˜¯undefinedã€‚</p>
<p>ç­‰æ•ˆäºï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> o2 = &#123;</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.num)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> o1 = &#123;</span><br><span class="line">  num: <span class="number">1</span>,</span><br><span class="line">  o2: o2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¦è¾¾æˆé¢„æœŸï¼Œå°±è¦æ€è€ƒæ€æ ·å»æ”¹å˜è¿™ä¸ª<code>this</code>çš„æŒ‡å‘ã€‚</p>
<h3 id="thisçš„ç»‘å®š"><a href="#thisçš„ç»‘å®š" class="headerlink" title="thisçš„ç»‘å®š"></a><code>this</code>çš„ç»‘å®š</h3><p>JavaScript æä¾›äº†<code>call</code>ã€<code>apply</code>ã€<code>bind</code>è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œæ¥åˆ‡æ¢/å›ºå®š<code>this</code>çš„æŒ‡å‘ã€‚</p>
<h4 id="Function-prototype-call"><a href="#Function-prototype-call" class="headerlink" title="Function.prototype.call()"></a><code>Function.prototype.call()</code></h4><p><code>call</code>æ–¹æ³•å¯ä»¥æŒ‡å®šå‡½æ•°å†…éƒ¨<code>this</code>çš„æŒ‡å‘ï¼Œæ˜¯å‡½æ•°å¯ä»¥åœ¨æŒ‡å®šçš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­æ‰§è¡Œã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> f = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() === <span class="built_in">window</span> <span class="comment">// true</span></span><br><span class="line">f.call(obj) === obj <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾ï¼Œæ‰§è¡Œ<code>call</code>æ–¹æ³•æ—¶çš„<code>this</code>æ”¹å˜æˆäº†<code>obj</code>è¿™ä¸ªå¯¹è±¡ã€‚</p>
<p><code>call</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœä¸ºç©ºã€<code>undefined</code>ã€<code>null</code>ï¼Œåˆ™<code>this</code>æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚å¦‚æœä¸ºåŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™<code>this</code>æŒ‡å‘è¯¥åŸå§‹ç±»å‹å€¼çš„åŒ…è£…å¯¹è±¡ã€‚</p>
<p><code>call</code>æ–¹æ³•åé¢çš„å‚æ•°ä¼šä¾æ¬¡ä¼ ç»™å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add.call(<span class="built_in">this</span>, <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>



<p><code>call</code>æ–¹æ³•çš„ä¸€ä¸ªåº”ç”¨æ˜¯è°ƒç”¨å¯¹è±¡çš„åŸç”Ÿæ–¹æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">obj.hasOwnProperty(<span class="string">&#x27;toString&#x27;</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¦†ç›–æ‰ç»§æ‰¿çš„ hasOwnProperty æ–¹æ³•</span></span><br><span class="line">obj.hasOwnProperty = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line">obj.hasOwnProperty(<span class="string">&#x27;toString&#x27;</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.prototype.hasOwnProperty.call(obj, <span class="string">&#x27;toString&#x27;</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>å°†<code>obj</code>å¯¹è±¡ä¸Šçš„<code>hasOwnProperty</code>æ–¹æ³•ä¿®æ”¹ä¹‹åï¼Œç›´æ¥é€šè¿‡<code>obj    .hasOwnProperty()</code>ä¸ä¼šå¾—åˆ°åº”æœ‰çš„ç»“æœã€‚è€Œé€šè¿‡<code>call</code>å¯ä»¥å»æŒ‡å®š<code>this</code>è°ƒç”¨åŸç”Ÿçš„<code>Object</code>ä¸Šçš„æ–¹æ³•ã€‚</p>
<h4 id="Function-prototype-apply"><a href="#Function-prototype-apply" class="headerlink" title="Function.prototype.apply()"></a><code>Function.prototype.apply()</code></h4><p>ä¸<code>call</code>åŸºæœ¬ä¸€è‡´ï¼Œå”¯ç‹¬åœ¨å®ƒæ¥å—çš„å‚æ•°åˆ—è¡¨ä¸Šä¸<code>call</code>ä¸åŒï¼Œç¬¬ä¸€ä¸ªä»æ˜¯æŒ‡å®š<code>this</code>çš„æŒ‡å‘å¯¹è±¡ï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°æ•°ç»„ã€‚</p>
<p>è¯¥å‚æ•°æ•°ç»„åœ¨æ‰§è¡Œæ—¶ä¼šè§£æ„èµ‹ç»™å‡½æ•°ã€‚</p>
<p>å¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call</span></span><br><span class="line">add.call(<span class="built_in">this</span>, <span class="number">1</span>,<span class="number">2</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// apply</span></span><br><span class="line">add.apply(<span class="built_in">this</span>, [<span class="number">1</span>, <span class="number">2</span>]) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç‰¹æ€§åœ¨<code>rest</code>è¿ç®—ç¬¦å‡ºç°ä¹‹å‰å°±æœ‰äº†å¾ˆå¤šæœ‰è¶£çš„ç©æ³•ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå°è¯•ã€‚</p>
<blockquote>
<ul>
<li>æ‰¾å‡ºæ•°ç»„çš„æœ€å¤§æœ€å°å€¼</li>
<li>å°†æ•°ç»„çš„ç©ºä½ç½®ä¸º<code>undefined</code></li>
<li>è½¬æ¢ç±»æ•°ç»„å¯¹è±¡ä¸ºæ•°ç»„å¯¹è±¡</li>
</ul>
</blockquote>
<h4 id="Function-prototype-bind"><a href="#Function-prototype-bind" class="headerlink" title="Function.prototype.bind()"></a><code>Function.prototype.bind()</code></h4><p><code>bind()</code>æ–¹æ³•ç”¨äºå°†å‡½æ•°ä½“å†…çš„<code>this</code>ç»‘å®šåˆ°æŸä¸ªå¯¹è±¡ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> counter1 = &#123;</span><br><span class="line">  count: <span class="number">0</span>,</span><br><span class="line">  increat: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.count++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter2 = &#123;</span><br><span class="line">  count: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> func = counter.increat.bind(counter2);</span><br><span class="line">func();</span><br><span class="line">counter1.count <span class="comment">// 0</span></span><br><span class="line">counter2.count <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>counter1.increat()</code>æ–¹æ³•è¢«èµ‹å€¼ç»™å˜é‡<code>func</code>ã€‚è¿™æ—¶å¿…é¡»ç”¨<code>bind()</code>æ–¹æ³•å°†<code>increat()</code>å†…éƒ¨çš„<code>this</code>ï¼Œç»‘å®šåˆ°<code>counter2</code>ï¼Œ<code>this</code>æŒ‡å‘çš„ä¾¿æ˜¯å¯¹è±¡<code>counter2</code>ï¼Œæ“ä½œçš„è‡ªåŠ æ“ä½œä¹Ÿæ˜¯é’ˆå¯¹<code>counter2.count</code>ã€‚</p>
<p><code>bind()</code>è¿˜å¯ä»¥æ¥å—æ›´å¤šçš„å‚æ•°ï¼Œå°†è¿™äº›å‚æ•°ç»‘å®šåŸå‡½æ•°çš„å‚æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * <span class="built_in">this</span>.m + y * <span class="built_in">this</span>.n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  m: <span class="number">1</span>,</span><br><span class="line">  n: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newAdd = add.bind(obj, <span class="number">5</span>);</span><br><span class="line">newAdd(<span class="number">5</span>) <span class="comment">// 20</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>bind()</code>æ–¹æ³•é™¤äº†ç»‘å®š<code>this</code>å¯¹è±¡ï¼Œè¿˜å°†<code>add()</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°<code>x</code>ç»‘å®šæˆ<code>5</code>ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°<code>newAdd()</code>ï¼Œè¿™ä¸ªå‡½æ•°åªè¦å†æ¥å—ä¸€ä¸ªå‚æ•°<code>y</code>å°±èƒ½è¿è¡Œäº†ã€‚</p>
<p>æ˜¯ä¸æ˜¯å¾ˆæœ‰æ„æ€ï¼è¿™å°±æœ‰äº†æ›´å¤šæœ‰è¶£çš„ç©æ³•ï¼ŒJSå¾ˆå¤šé«˜çº§ç¼–ç¨‹éƒ½å¯ä»¥é€šè¿‡<code>bind</code>æ¥å®ç°ã€‚å°±å½“æ˜¯æŒ–ä¸ªå‘å§ï¼Œæœ‰ç©ºå†å¡«ã€‚</p>
<h2 id="å°±è¿™æ ·ï¼Œç™½ç™½ï½"><a href="#å°±è¿™æ ·ï¼Œç™½ç™½ï½" class="headerlink" title="å°±è¿™æ ·ï¼Œç™½ç™½ï½"></a>å°±è¿™æ ·ï¼Œç™½ç™½ï½</h2>]]></content>
  </entry>
  <entry>
    <title>é‡æ‹¾JS(äºŒ)--æµ…è°ˆè£…é¥°å™¨decorator</title>
    <url>/2020/11/14/%E9%87%8D%E6%8B%BEJS%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<h1 id="é‡æ‹¾JS-äºŒ-â€“æµ…è°ˆè£…é¥°å™¨decorator"><a href="#é‡æ‹¾JS-äºŒ-â€“æµ…è°ˆè£…é¥°å™¨decorator" class="headerlink" title="é‡æ‹¾JS(äºŒ)â€“æµ…è°ˆè£…é¥°å™¨decorator"></a>é‡æ‹¾JS(äºŒ)â€“æµ…è°ˆè£…é¥°å™¨decorator</h1><blockquote>
<p>è£…é¥°å™¨è¿™ä¸ªæ¦‚å¿µåº”è¯¥æ˜¯ä»Pythoné‚£è¾¹æŠ„è¿‡æ¥çš„ï¼Œæ­£å¦‚å…¶åï¼Œå®ƒå¯ä»¥å¯¹ä¸€äº›å¯¹è±¡è¿›è¡Œè£…é¥°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p>
</blockquote>
<h2 id="ç•¥è§ˆ"><a href="#ç•¥è§ˆ" class="headerlink" title="ç•¥è§ˆ"></a>ç•¥è§ˆ</h2><ul>
<li>pythonä¸­ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨pythonä¸­è£…é¥°å™¨çš„ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">inner_func</span>(<span class="params">arg</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;inner_func&#x27;</span> + func(arg))</span><br><span class="line">  <span class="keyword">return</span> inner_func</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">common_func</span>(<span class="params">arg</span>):</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;the arg from common func&#x27;</span> + arg</span><br><span class="line"></span><br><span class="line">common_func(<span class="string">&#x27;the arguments&#x27;</span>)</span><br><span class="line"><span class="comment"># inner_functhe arg from common functhe arguments</span></span><br></pre></td></tr></table></figure>

<ul>
<li>JSä¸­ï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@decoratorTheClass</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  @decoratorTheProperty())</span><br><span class="line">  method() &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¸Šé¢çš„decoratorTheClassä»¥åŠdecoratorThePropertyå°±æ˜¯JSä¸­çš„å®ä¾‹è£…é¥°å™¨ã€‚</p>
<p>äºŒè€…åœ¨ä½¿ç”¨ä¸Šéå¸¸ç›¸ä¼¼ã€‚ä¸Šè¿°ä¾‹å­é€šè¿‡<code>@</code>æ¥ä½¿ç”¨è£…é¥°å™¨ã€‚ä¸€å…±ç”¨äº†ä¸¤ç§ï¼šä¸€ä¸ªç”¨åœ¨ç±»ä¸Šï¼Œä¸€ä¸ªç”¨åœ¨æ–¹æ³•ä¸Šã€‚</p>
<p>JSä¸­çš„è£…é¥°å™¨æ˜¯åœ¨ES7ä¸­çš„ï¼Œå®ƒä¾èµ–äºES5ä¸­çš„<code>Object.defineProperty</code>è¿™ä¸ªAPIã€‚</p>
<h2 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty"></a><code>Object.defineProperty</code></h2><p><code>Object.defineProperty</code>æ‰€åšçš„äº‹æƒ…å°±æ˜¯ï¼Œ<strong>ä¸ºä¸€ä¸ªå¯¹è±¡å¢åŠ æ–°çš„å±æ€§ï¼Œæˆ–è€…æ›´æ”¹å¯¹è±¡æŸä¸ªå·²å­˜åœ¨çš„å±æ€§ã€‚</strong>è°ƒç”¨æ–¹å¼æ˜¯<code>Object.defineProperty(targetObj, prop, descriptor)</code>ï¼Œè¿™ 3 ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨ï¼š</p>
<ul>
<li><p><code>targetObj</code>:è¦å¤„ç†çš„å¯¹è±¡</p>
</li>
<li><p><code>prop</code>:è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§</p>
</li>
<li><p><code>descriptor</code>:å°†è¢«å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§æè¿°ç¬¦</p>
</li>
</ul>
<p>æœ‰æ„æ€çš„æ˜¯<code>descriptor</code> å‚æ•°ï¼Œå®ƒå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å­—æ®µå†³å®šäº† <code>targetObj</code>çš„<code>prop</code> å±æ€§çš„ä¸€äº›ç‰¹æ€§ã€‚æ¯”å¦‚<code> enumerable</code> çš„çœŸå‡å°±èƒ½å†³å®šç›®æ ‡å¯¹è±¡æ˜¯å¦å¯æšä¸¾â€¦è¿™äº›å±æ€§ã€‚</p>
<h3 id="descriptor"><a href="#descriptor" class="headerlink" title="descriptor"></a><code>descriptor</code></h3><blockquote>
<p>å±æ€§æè¿°</p>
</blockquote>
<p>å®šä¹‰çš„å¯¹è±¡ä¸­ï¼Œæ¯ä¸€ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡ï¼Œç”¨æ¥æè¿°è¯¥å±æ€§çš„åŸºæœ¬ç‰¹æ€§ã€‚</p>
<p>ç›®å‰æœ‰ä¸¤ç§å±æ€§æè¿°ç¬¦ï¼š</p>
<ul>
<li><strong>æ•°æ®æè¿°ç¬¦</strong>ï¼šä¸€ä¸ªå…·æœ‰å€¼çš„å±æ€§ã€‚è¯¥å€¼ä¼šè®¾ç½®æ˜¯å¦å¯è¢«é‡å†™ã€‚</li>
<li><strong>å­˜å–æè¿°ç¬¦</strong>ï¼šç”±<code>getter-setter</code>å‡½æ•°å¯¹æè¿°çš„å±æ€§ã€‚</li>
</ul>
<blockquote>
<p> å±æ€§æè¿°ç¬¦å¿…é¡»æ˜¯è¿™ä¸¤ç§å½¢å¼ä¹‹ä¸€, ä¸¤ç§å½¢å¼ä¸å…±å­˜ã€‚</p>
</blockquote>
<h2 id="Decoratoråœ¨classä¸­ä½¿ç”¨"><a href="#Decoratoråœ¨classä¸­ä½¿ç”¨" class="headerlink" title="@Decoratoråœ¨classä¸­ä½¿ç”¨"></a>@Decoratoråœ¨classä¸­ä½¿ç”¨</h2><blockquote>
<p>è£…é¥°å™¨å¯ä»¥ç”¨æ¥è£…é¥°æ•´ä¸ªç±»ã€‚</p>
</blockquote>
<h3 id="æ–°å¢å±æ€§"><a href="#æ–°å¢å±æ€§" class="headerlink" title="æ–°å¢å±æ€§"></a>æ–°å¢å±æ€§</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@name</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">name</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  target.name = <span class="string">&quot;çŒ«çŒ«&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¾ç¤º&quot;çŒ«çŒ«&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(Cat.name)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>@testable</code> å°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ã€‚å®ƒä¿®æ”¹ <code>MyTestableClass</code> è¿™ä¸ªç±»çš„å±æ€§ï¼Œä¸ºå®ƒåŠ ä¸Šäº†é™æ€å±æ€§ <code>isTestable</code>ã€‚<code>testable</code> å‡½æ•°çš„å‚æ•° <code>target</code>æ˜¯ <code>MyTestableClass</code> ç±»æœ¬èº«ã€‚</p>
<h3 id="ä¿®æ”¹åŸæœ‰å±æ€§çš„æè¿°ç¬¦"><a href="#ä¿®æ”¹åŸæœ‰å±æ€§çš„æè¿°ç¬¦" class="headerlink" title="ä¿®æ”¹åŸæœ‰å±æ€§çš„æè¿°ç¬¦"></a>ä¿®æ”¹åŸæœ‰å±æ€§çš„æè¿°ç¬¦</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@seal</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  sayHi() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">seal</span>(<span class="params">constructor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(constructor.prototype, &#x27;sayHi&#x27;)</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(constructor.prototype, &#x27;sayHi&#x27;, &#123;</span><br><span class="line">    ...descriptor,</span><br><span class="line">    writable: <span class="literal">false</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.sayHi = <span class="number">1</span> <span class="comment">// æ— æ•ˆ</span></span><br></pre></td></tr></table></figure>

<h3 id="å¤šä¸ªè£…é¥°å™¨åŒæ—¶ä½¿ç”¨"><a href="#å¤šä¸ªè£…é¥°å™¨åŒæ—¶ä½¿ç”¨" class="headerlink" title="å¤šä¸ªè£…é¥°å™¨åŒæ—¶ä½¿ç”¨"></a>å¤šä¸ªè£…é¥°å™¨åŒæ—¶ä½¿ç”¨</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@decorator1</span><br><span class="line">@decorator2</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span></span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œçš„é¡ºåºä¸º<code>decorator2</code> -&gt; <code>decorator1</code>ï¼Œç¦»<code>class</code>å®šä¹‰æœ€è¿‘çš„å…ˆæ‰§è¡Œã€‚</p>
<h2 id="Decoratoråœ¨classå±æ€§ä¸Šä½¿ç”¨"><a href="#Decoratoråœ¨classå±æ€§ä¸Šä½¿ç”¨" class="headerlink" title="@Decoratoråœ¨classå±æ€§ä¸Šä½¿ç”¨"></a>@Decoratoråœ¨classå±æ€§ä¸Šä½¿ç”¨</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readonly</span>(<span class="params">target, key, descriptor</span>) </span>&#123;</span><br><span class="line">  descriptor.writable = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">return</span> descriptor</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">  @readonly</span><br><span class="line">  bark () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;wang!wang!&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dog. = <span class="keyword">new</span> Dog()</span><br><span class="line">dog.bark = <span class="string">&#x27;bark! bark!&#x27;</span></span><br><span class="line"><span class="comment">// Cannot assign to read only property &#x27;bark&#x27; of [object Object]</span></span><br></pre></td></tr></table></figure>

<p><code>decorator</code> å°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œåªä¸è¿‡å®ƒæ¥æ”¶ 3 ä¸ªå‚æ•°ï¼Œä¸<code>Object.defineProperty</code> ä¸€è‡´ã€‚å…·ä½“åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯æŠŠ <code>descriptor</code> çš„<code>writable</code> å­—æ®µè®¾ä¸º <code>false</code>ã€‚ç„¶åæŠŠ <code>readonly </code>ä½œç”¨åˆ°<code> bark</code> æ–¹æ³•ä¸Šã€‚</p>
<p>å®ƒçš„å…·ä½“æ“ä½œæ­¥éª¤æ˜¯æ€ä¹ˆè¿è¡Œçš„å‘¢ï¼Ÿè¿™é‡Œç»™å‡ºå®ƒè½¬æ¢æˆES5ä¹‹åçš„ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ­¥éª¤ 1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¥éª¤ 2</span></span><br><span class="line"><span class="keyword">let</span> descriptor = &#123;</span><br><span class="line">  value: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">&#x27;wang!wang!&#x27;</span> &#125;,</span><br><span class="line">  enumerable: <span class="literal">false</span>,</span><br><span class="line">  configurable: <span class="literal">true</span>,</span><br><span class="line">  writable: <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">descriptor = readonly(Dog.prototype, <span class="string">&#x27;bark&#x27;</span>, descriptor) || descriptor</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Dog.prototype, <span class="string">&#x27;bark&#x27;</span>, descriptor)</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¯´å‘¢ï¼ŒES7 çš„ <code>decorator</code>ï¼Œä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„ <code>descriptor</code>ï¼Œå¹¶æŠŠè¿™ä¸ªæ–°è¿”å›çš„ <code>descriptor</code> åº”ç”¨åˆ°ç›®æ ‡å±æ€§ä¸Šã€‚</p>
<h2 id="ä½¿ç”¨é—­åŒ…æ¥å®ç°mixin"><a href="#ä½¿ç”¨é—­åŒ…æ¥å®ç°mixin" class="headerlink" title="ä½¿ç”¨é—­åŒ…æ¥å®ç°mixin"></a>ä½¿ç”¨é—­åŒ…æ¥å®ç°mixin</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123; say() &#123; <span class="keyword">return</span> <span class="number">1</span> &#125; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123; hi() &#123; <span class="keyword">return</span> <span class="number">2</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line">@mixin(A, B)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mixin</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">constructor</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> arg <span class="keyword">of</span> args) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.getOwnPropertyNames(arg.prototype)) &#123;</span><br><span class="line">                <span class="comment">// è·³è¿‡æ„é€ å‡½æ•°</span></span><br><span class="line">                <span class="keyword">if</span> (key === <span class="string">&#x27;constructor&#x27;</span>) <span class="keyword">continue</span> </span><br><span class="line">                <span class="built_in">Object</span>.defineProperty(constructor.prototype, key, <span class="built_in">Object</span>.getOwnPropertyDescriptor(arg.prototype, key))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> C()</span><br><span class="line"><span class="built_in">console</span>.log(c.say(), c.hi()) <span class="comment">// 1, 2</span></span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<a href="https://link.zhihu.com/?target=http://raganwald.com/">raganwald</a>ï¼ˆ<em>JavaScript AllongÃ©, the â€œSixâ€ Edition</em> çš„ä½œè€…ï¼‰å†™äº†<a href="https://link.zhihu.com/?target=http://raganwald.com/2015/06/26/decorators-in-es7.html">ä¸€ç¯‡æ–‡ç« </a>ä»‹ç»å¦‚ä½•ä½¿ç”¨ decorator æ¥å®ç° mixinã€‚è¿™å¯¹æ¡†æ¶å’Œç±»åº“ä½œè€…æ¥è¯´æ˜¯ä¸€ä¸ªé‡ç£…å¥½æ¶ˆæ¯ã€‚</p>
<h2 id="Decorator-æœ‰å•¥ç”¨"><a href="#Decorator-æœ‰å•¥ç”¨" class="headerlink" title="@Decorator æœ‰å•¥ç”¨"></a>@Decorator æœ‰å•¥ç”¨</h2><p>åœ¨ Python é‡Œï¼Œ<code>decorator</code> çš„ä½œç”¨éå¸¸ä¸°å¯Œï¼Œæ¯”å¦‚å¯ä»¥å®šä¹‰ä¸€äº›å¿«æ·æ–¹å¼ï¼ˆå¦‚@staticmethodï¼Œ@classmethod ä¹‹ç±»ï¼‰ï¼Œæ¯”å¦‚æ„å»ºåç«¯æœåŠ¡Flaskæ¡†æ¶ä¸­çš„è·¯ç”±è“å›¾ç­‰ç­‰ã€‚</p>
<p>è€Œåœ¨JSä¸­å‘¢ï¼Œæœ€ä¸ºå¸¸è§çš„å°±æ˜¯åç«¯æœåŠ¡ä¸­nestjsæ¡†æ¶çš„åº”ç”¨ï¼ŒåŒæ—¶é…åˆTypescriptä¼šæœ‰å¾ˆå¤šæœ‰è¶£çš„æ“ä½œã€‚ä¹Ÿæœ‰å¾ˆå¤šäººå·²ç»åšå¥½äº†éå¸¸æ–¹ä¾¿çš„å·¥å…·åº“ï¼Œä½¿ç”¨æ—¶ä¸€ä¸ª<code>@</code>ç¬¦å°±èƒ½çœå»å¾ˆå¤šä»£ç ã€‚</p>
<p>è™½ç„¶è¿‘å¹´æ¥å®ƒçš„ç›¸å…³ææ¡ˆå†…å®¹æ›´æ”¹æå¤§ï¼Œä½†è¿˜æ˜¯å¾ˆå…·æœ‰å­¦ä¹ ä»·å€¼çš„ã€‚å°±è¿™æ ·ï¼Œæºœäº†æºœäº†ï½</p>
]]></content>
  </entry>
</search>
